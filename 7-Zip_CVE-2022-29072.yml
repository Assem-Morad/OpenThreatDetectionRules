title: 7-Zip CVE-2022-29072
id: bb0c45aa-d7bb-4084-b156-359bf4ba4eb2
description: Detects 7zFM.exe starting uncommon subprocess cmd.exe which may reveal command injection due to an exploitation of CVE-2022-29072 "7-Zip Privilege Escalation Vulnerability in the 7-zip software".
status: stable
date: 2021/04/17
author: Cyber Castle [Ahmed Essam]
tags:
  - attack.T1068
  - attack.PrivilegeEscalation
#security logs
logsource:
    product: windows
    service: security
    description: Event ID 4688 (process creation) must be enabled which is not the default.
detection:
    ProcessCreation:
        EventID: 4688
        ParentProcessName: '7zFM.exe'
        TokenElevationType: '%%1936'
    condition: ProcessCreation
falsepositives:
    - Unknown
level: high
---
title: 7-Zip CVE-2022-29072
id: bb0c45aa-d7bb-4084-b156-359bf4ba4eb7
description: Detects 7zFM.exe starting uncommon child process cmd.exe which may reveal command injection due to an exploitation of CVE-2022-29072 "7-Zip Privilege Escalation Vulnerability in the 7-zip software".
status: stable
date: 2021/04/17
author: CyberCastle [Ahmed Essam]
tags:
  - attack.T1068
  - attack.PrivilegeEscalation
#sysmon logs
logsource:
    product: windows
    service: sysmon
    definition:
        - SysmonModular rules containes default rules will generate the required logs for this rule
        - those event could be mapped to any EDR equivelent events.  
detection:
    ProcessCreation:
        EventID: 1
        ParentProcessName: '7zFM.exe'
        Integritylevel: 'System'
    condition: ProcessCreation
falsepositives:
    - Unknown
level: high
